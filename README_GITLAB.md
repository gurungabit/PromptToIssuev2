# GitLab Integration Guide

## üöÄ Overview

The Prompt to Issue tool now includes full GitLab integration, allowing you to automatically create GitLab issues from AI-generated tickets. This integration supports project discovery, milestone management, hierarchical group structures, and intelligent caching.

## ‚ú® Features

### üéØ **Core Functionality**

- **Automatic Issue Creation**: Convert AI-generated tickets into GitLab issues
- **Project Discovery**: Browse and search all accessible GitLab projects
- **Milestone Management**: Assign issues to project or group milestones
- **Hierarchical Support**: Automatically fetches milestones from parent groups
- **Batch Processing**: Create multiple issues simultaneously

### üîç **Search & Discovery**

- **Project Search**: Real-time search by name and namespace
- **Milestone Search**: Filter milestones by title
- **Custom Project ID**: Direct access by entering project ID
- **Smart Caching**: 5-minute milestone cache for improved performance

### üé® **User Experience**

- **Dual-Panel Interface**: Projects on left, milestones on right
- **Visual Feedback**: Loading states, error handling, success indicators
- **External Links**: Quick access to GitLab project/milestone pages
- **Responsive Design**: Works on desktop, tablet, and mobile

## üõ†Ô∏è Setup Instructions

### Step 1: Configure GitLab Connection

1. **Open Settings**
   - Click the settings icon in the top-right corner
   - Navigate to "Platform Connections" tab

2. **Enter GitLab Details**

   ```
   GitLab URL: https://gitlab.com (or your instance URL)
   ```

3. **Create Personal Access Token**
   - Click "Create token" link or visit: `https://gitlab.com/-/profile/personal_access_tokens`
   - Create token with **"api"** scope
   - Copy the generated token

4. **Configure Access**

   ```
   Personal Access Token: glpat-xxxxxxxxxxxxxxxxxxxx
   Default Project ID: 12345 (optional)
   ```

5. **Test Connection**
   - Click "Test Connection" to verify setup
   - Save configuration once test passes

### Step 2: Required GitLab Permissions

Your Personal Access Token needs the following scope:

- **`api`** - Full API access for creating issues and reading projects/milestones

Ensure you have the following permissions in target projects:

- **Developer** or higher role for creating issues
- **Reporter** or higher for reading milestones

## üìã Usage Guide

### Creating GitLab Issues

1. **Generate Tickets**
   - Switch to "Ticket Mode" in the chat interface
   - Describe your feature or requirements
   - Review generated tickets in the preview panel

2. **Approve and Create**
   - Click "Approve & Create" button
   - Project Selection Modal opens automatically

3. **Select Target Project**
   - Browse projects in the left panel
   - Use search to find specific projects
   - Or enter project ID directly in the input field

4. **Choose Milestone (Optional)**
   - Select a milestone from the right panel
   - Search milestones by title
   - Choose "No Milestone" to create without milestone

5. **Create Issues**
   - Click "Create X Issues" button
   - Monitor progress and view results
   - Issues are created with rich formatting

### Project Selection Features

#### **Project Discovery**

- **Search Projects**: Type in search box to filter by name/namespace
- **Recent Activity**: Projects sorted by last activity
- **Custom Project ID**: Enter project ID for direct access
- **External Links**: Click external link icon to open project in GitLab

#### **Milestone Selection**

- **Hierarchical Milestones**: Automatically includes parent group milestones
- **Active Only**: Shows only active milestones
- **Due Date Display**: Shows milestone due dates when available
- **Search Functionality**: Filter milestones by title

## üé® Issue Format

Created GitLab issues include rich formatting with all ticket details:

```markdown
[Original ticket description]

## Acceptance Criteria

1. User can login with email and password
2. System validates credentials against database
3. Successful login redirects to dashboard

## Tasks

- [ ] Create login form component (3h)
- [ ] Implement authentication API (4h)
- [ ] Add password validation (1h)
- [ ] Create user session management (2h)

---

**Type:** feature
**Priority:** high
**Estimated Hours:** 10

_This issue was automatically generated by the Prompt to Issue tool._
```

## üîß Advanced Configuration

### Custom GitLab Instance

For self-hosted GitLab instances:

```
GitLab URL: https://gitlab.company.com
Personal Access Token: [Your token]
```

### Default Project Configuration

Set a default project to skip selection:

```
Default Project ID: 12345
```

This will pre-select the project in the modal, but you can still change it.

### Milestone Caching

The system caches milestones for 5 minutes per project to improve performance:

- First load fetches from GitLab API
- Subsequent loads use cached data
- Cache automatically expires after 5 minutes
- Cache cleared when switching projects

## üîç Hierarchical Milestone Support

For nested project structures like `root/subgroup/project`, the system automatically:

1. **Fetches Project Milestones**
   - Direct milestones assigned to the project

2. **Traverses Group Hierarchy**
   - Walks up the namespace tree
   - Fetches milestones from each parent group

3. **Merges and Deduplicates**
   - Combines all milestone sources
   - Removes duplicate milestones
   - Sorts alphabetically by title

**Example Structure:**

```
Company Group
‚îú‚îÄ‚îÄ Milestones: Q1 2024, Q2 2024
‚îú‚îÄ‚îÄ Backend Team
‚îÇ   ‚îú‚îÄ‚îÄ Milestones: Sprint 1, Sprint 2
‚îÇ   ‚îî‚îÄ‚îÄ Auth Service Project
‚îÇ       ‚îî‚îÄ‚îÄ Milestones: v1.0, v1.1
```

**Available Milestones:** Q1 2024, Q2 2024, Sprint 1, Sprint 2, v1.0, v1.1

## üö® Troubleshooting

### Common Issues

#### **Connection Failed**

```
Error: GitLab API error: 401 - Unauthorized
```

**Solution:**

- Verify your Personal Access Token is correct
- Ensure token has "api" scope
- Check if token hasn't expired

#### **Project Not Found**

```
Error: GitLab API error: 404 - Project not found
```

**Solution:**

- Verify project ID is correct
- Ensure you have access to the project
- Check if project exists and isn't archived

#### **No Projects Listed**

**Solution:**

- Verify your token has correct permissions
- Check if you're a member of any projects
- Try searching for specific project names

#### **Milestones Not Loading**

**Solution:**

- Ensure project has active milestones
- Check parent groups for inherited milestones
- Verify milestone permissions

### API Rate Limits

GitLab has API rate limits:

- **Free tier**: 2,000 requests per minute
- **Premium/Ultimate**: Higher limits

The integration is optimized to minimize API calls through:

- Efficient pagination
- Milestone caching
- Batch operations

### Network Issues

For connection problems:

1. Check internet connectivity
2. Verify GitLab instance is accessible
3. Test GitLab URL in browser
4. Check firewall/proxy settings

## üîê Security Best Practices

### Token Management

- **Scope Limitation**: Only grant "api" scope, not full access
- **Regular Rotation**: Rotate tokens periodically
- **Secure Storage**: Tokens are stored in browser localStorage
- **No Server Storage**: Tokens never sent to our servers

### Access Control

- **Minimum Permissions**: Use lowest required project role
- **Project-Specific**: Consider project-specific tokens if available
- **Team Coordination**: Inform team about automated issue creation

## üöÄ Performance Optimization

### Caching Strategy

- **Milestone Cache**: 5-minute TTL per project
- **Project List**: Fetched on modal open
- **Search Results**: Real-time, no caching

### API Efficiency

- **Pagination**: Fetches all pages automatically
- **Batch Creation**: Creates multiple issues efficiently
- **Parallel Requests**: Milestone fetching uses parallel API calls

## üìä Monitoring & Analytics

### Success Tracking

The system provides detailed feedback:

- Number of issues created successfully
- List of created issues with links
- Error details for failed creations

### Error Reporting

Comprehensive error handling with:

- Specific error messages
- Suggested solutions
- Retry mechanisms where appropriate

## üîÑ Future Enhancements

### Planned Features

- **Issue Templates**: Use GitLab issue templates
- **Labels Management**: Automatic label assignment
- **Assignee Selection**: Assign issues to team members
- **Epic Integration**: Link issues to epics
- **Webhooks**: Real-time status updates

### Integration Roadmap

- **GitHub Integration**: Similar functionality for GitHub
- **Jira Integration**: Enterprise ticket management
- **Linear Integration**: Modern project management
- **Custom Webhooks**: Generic webhook support

## üìû Support

### Getting Help

- **Documentation**: This README covers most use cases
- **Error Messages**: Check error details for specific guidance
- **GitLab Documentation**: Refer to GitLab API docs for advanced usage

### Reporting Issues

When reporting issues, include:

- GitLab instance URL (without sensitive data)
- Error messages (redact tokens)
- Steps to reproduce
- Browser and version information

---

## üéâ Conclusion

The GitLab integration provides a seamless workflow from AI-generated tickets to GitLab issues. With intelligent project discovery, hierarchical milestone support, and robust error handling, it's designed to enhance your development workflow while maintaining security and performance.

Happy ticket creation! üöÄ
